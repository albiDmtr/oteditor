import{s as ae,e as B,z as se,q as G,a as P,b as Y,A as oe,d as k,w as Z,k as p,i as V,y as $,C as U,E as ye,r as de,$ as rt,n as He,j as Le,l as te,m as re,o as ke,p as ue,x as ce,D as Ke,a0 as pe,a1 as ge,a2 as je,I as ve,J as we,L as ee,G as ze,v as at,Z as lt}from"../chunks/scheduler.BNZeKrfj.js";import{S as le,i as ie,c as W,b as q,m as F,t as O,a as J,d as K,g as De,e as Ne,f as it}from"../chunks/index.D5VrrNi7.js";import{w as Te,g as ne}from"../chunks/entry.DCR3iCnf.js";import{H as ut,P as be,u as Ue,B as ct,E as mt,g as ft,S as dt,C as ht,a as pt,b as gt,c as vt,D as Qe,d as wt,J as _t,T as kt,N as bt}from"../chunks/TopBar.Di-kv4dv.js";import{e as he,u as yt,o as Ct}from"../chunks/each.te9pOleI.js";import{t as Ae,a as Ce,k as Be,l as $e,b as x,m as Et,u as St,o as xe,p as Pe,q as It,v as Dt,w as Nt,x as $t,y as jt,e as Ve,d as Ee,c as Mt,z as Ht,n as Oe,s as Lt,_ as Ye,A as Je,B as zt,C as Tt,D as At,j as Bt}from"../chunks/stores.B04GNUkc.js";import{S as Pt,A as Vt,W as Ot,O as Yt,P as Jt,a as Xt,M as fe,D as Rt,C as Se,b as Ie,B as Gt}from"../chunks/three.module.BaM-MH9J.js";import{S as Zt}from"../chunks/Sidebar.DL3x2y55.js";import{D as Wt}from"../chunks/DropdownMenu.1kWrqv_O.js";import{D as et}from"../chunks/DialogBox.cebySumd.js";import{B as Me}from"../chunks/Button.D-NdZsbg.js";const qt=({params:s})=>({systemId:s.systemId}),Jn=Object.freeze(Object.defineProperty({__proto__:null,load:qt},Symbol.toStringTag,{value:"Module"}));function Ft(s){let e,t,n,r,o,a,i,d,v,m,b;return i=new ut({props:{type:s[0]==="input"?"target":"source",id:`${s[2]}.${s[1]}`,position:s[0]==="input"?be.Left:be.Right,style:"position: relative; top: 0; left: 0; transform: none;"}}),{c(){e=B("div"),t=B("div"),n=se(s[1]),o=G(),a=B("div"),W(i.$$.fragment),this.h()},l(_){e=P(_,"DIV",{class:!0,style:!0});var c=Y(e);t=P(c,"DIV",{class:!0});var g=Y(t);n=oe(g,s[1]),g.forEach(k),o=Z(c),a=P(c,"DIV",{class:!0});var f=Y(a);q(i.$$.fragment,f),f.forEach(k),c.forEach(k),this.h()},h(){p(t,"class",r="tooltip "+(s[3]?"hover":"")+" svelte-wvrdh7"),p(a,"class","handle-inner svelte-wvrdh7"),p(e,"class","handle-outer svelte-wvrdh7"),p(e,"style",d=`transform: translate(${s[0]==="input"?"-":""}50%, 0);`)},m(_,c){V(_,e,c),$(e,t),$(t,n),$(e,o),$(e,a),F(i,a,null),v=!0,m||(b=[U(a,"mouseenter",s[5]),U(a,"mouseleave",s[6])],m=!0)},p(_,[c]){(!v||c&2)&&ye(n,_[1]),(!v||c&8&&r!==(r="tooltip "+(_[3]?"hover":"")+" svelte-wvrdh7"))&&p(t,"class",r);const g={};c&1&&(g.type=_[0]==="input"?"target":"source"),c&6&&(g.id=`${_[2]}.${_[1]}`),c&1&&(g.position=_[0]==="input"?be.Left:be.Right),i.$set(g),(!v||c&1&&d!==(d=`transform: translate(${_[0]==="input"?"-":""}50%, 0);`))&&p(e,"style",d)},i(_){v||(O(i.$$.fragment,_),v=!0)},o(_){J(i.$$.fragment,_),v=!1},d(_){_&&k(e),K(i),m=!1,de(b)}}}function Kt(s,e,t){let{type:n}=e,{elementName:r}=e,{componentName:o}=e;const a=rt();let i=!1;const d=()=>{t(3,i=!0),a("mouseenter")},v=()=>{t(3,i=!1),a("mouseleave")};return s.$$set=m=>{"type"in m&&t(0,n=m.type),"elementName"in m&&t(1,r=m.elementName),"componentName"in m&&t(2,o=m.componentName)},[n,r,o,i,a,d,v]}class tt extends le{constructor(e){super(),ie(this,e,Kt,Ft,ae,{type:0,elementName:1,componentName:2})}}function Ut(s){let e,t,n,r;return{c(){e=B("canvas"),this.h()},l(o){e=P(o,"CANVAS",{class:!0}),Y(e).forEach(k),this.h()},h(){p(e,"class",t=He(s[2]?"loaded":"loading")+" svelte-3724t2")},m(o,a){V(o,e,a),s[7](e),n||(r=[U(e,"mousemove",function(){Le(s[0]?s[4]:void 0)&&(s[0]?s[4]:void 0).apply(this,arguments)}),U(e,"mouseleave",function(){Le(s[0]?s[3]:void 0)&&(s[0]?s[3]:void 0).apply(this,arguments)})],n=!0)},p(o,[a]){s=o,a&4&&t!==(t=He(s[2]?"loaded":"loading")+" svelte-3724t2")&&p(e,"class",t)},i:te,o:te,d(o){o&&k(e),s[7](null),n=!1,de(r)}}}let _e=34;function Qt(s,e,t){let n;re(s,Ae,h=>t(12,n=h));let{data:r={name:"",elements:[]}}=e,{hoverable:o=!0}=e,{highlightedElement:a=null}=e,i,d,v=!1;const m=new Pt,b=new Vt(16777215,1);m.add(b);const _=(h,D,C,T,X=!1)=>{const A=new Rt(16777215,1);A.position.set(D,C,T),X&&(A.castShadow=!0,A.shadow.camera.near=.05,A.shadow.camera.far=500,A.shadow.camera.left=-400,A.shadow.camera.right=400,A.shadow.camera.top=400,A.shadow.camera.bottom=-400,A.shadow.mapSize.width=2048,A.shadow.mapSize.height=2048,A.shadow.radius=12),h.add(A)};_(m,0,200,0,!0),_(m,100,200,200),_(m,-100,-200,-100);const c=(h,D,C,T)=>{const X=new Se(17,17,6,32),A=new Ie({color:4777410,transparent:!0}),u=new fe(X,A);u.castShadow=!0,u.rotateX(Math.PI*(90/180)),u.position.x=T,u.position.y=C,u.position.z=D-3,u.name=h,m.add(u)},g=(h,D,C,T)=>{const X=new Se(4,4,20,32),A=new Ie({color:0,transparent:!0}),u=new fe(X,A);u.castShadow=!0,u.rotateX(Math.PI*(90/180)),u.position.x=T,u.position.y=C,u.position.z=D-10,u.name=h,m.add(u)},f=(h,D,C,T)=>{const X=new Se(18,18,7,32),A=new Ie({color:4777410,transparent:!0}),u=new fe(X,A);u.castShadow=!0;const L=new Gt(4,8,7),R=z=>{const Q=new fe(L,A);Q.position.set(19*Math.cos(z),19*Math.sin(z),0),Q.rotateZ(z),u.add(Q)};for(let z=0;z<8;z++)R(z*Math.PI/4);X.rotateX(Math.PI*(90/180)),u.position.x=T,u.position.y=C,u.position.z=D-3.5,u.name=h,m.add(u)};let y=0,S=0;const j=()=>{if(d&&n){d.canvas.width=i.clientWidth,d.canvas.height=i.clientHeight;let h=window.devicePixelRatio||1;n.setSize(d.canvas.width/h*2,d.canvas.height/h*2,!1),d.clearRect(0,0,d.canvas.width,d.canvas.height),n.render(m,M),d.drawImage(n.domElement,0,0,d.canvas.width,d.canvas.height),t(2,v=!0)}};let M;ke(()=>{if(!n){const z=new Ot({antialias:!0,alpha:!0});z.setPixelRatio(window.devicePixelRatio),z.shadowMap.enabled=!0,Ae.set(z)}let h=0,D=0,C=0,T=new Map;r.elements.forEach(z=>{z.type==="Disk"?(c(z.name,h,D,C),h-=6):z.type==="ShaftDiscrete"||z.type==="ShaftContinuous"?(g(z.name,h,D,C),h-=20):z.type==="GearElement"&&(z.parent&&T.get(z.parent)&&z.name!==z.parent?(T.set(z.name,T.get(z.parent)),D+=_e,T.get(z.name).endY=D,h=T.get(z.parent).z):T.set(z.name,{z:h,endY:D}),D%(_e*2)!==0?C=_e/1.5:C=0,f(z.name,h,D,C),h-=7),h<y&&(y=h),D>S&&(S=D)});const X=Math.max(S,-y*.45),A=70+Math.min(X,116);M=new Yt(-A/2,A/2,A/2,-A/2,.1,1e3);const u=new Jt(2e3,2e3),L=new Xt({opacity:.15}),R=new fe(u,L);R.receiveShadow=!0,R.name="shadowPlane",R.rotation.x=-Math.PI/2,R.position.y=-21,R.position.z=0,m.add(R),I(),H(),window.addEventListener("resize",I),d=i.getContext("2d"),j()});const I=()=>{i&&M.updateProjectionMatrix()},H=()=>{const h=S?_e/2:0;M.position.set(70+h/2,85+S/2,88+y/2),M.lookAt(h/2,S/2,y/2),j()},E=h=>{const D=i.clientWidth,C=i.getBoundingClientRect(),T=h.clientX-C.left,X=S?_e/2:0,A=100,u=(1-T/D)*(y-2*A)+A;M.position.set(70+X/2,85+S/2,u),M.lookAt(X/2,S/2,y/2),j()},l=h=>{h?(m.traverse(D=>{D instanceof fe&&D.name&&D.name!==h&&D.name!=="shadowPlane"&&(D.material.opacity=.2)}),j()):(m.traverse(D=>{D instanceof fe&&D.name!=="shadowPlane"&&(D.material.opacity=1)}),j())};function w(h){ue[h?"unshift":"push"](()=>{i=h,t(1,i)})}return s.$$set=h=>{"data"in h&&t(5,r=h.data),"hoverable"in h&&t(0,o=h.hoverable),"highlightedElement"in h&&t(6,a=h.highlightedElement)},s.$$.update=()=>{s.$$.dirty&64&&l(a)},[o,i,v,H,E,r,a,w]}class nt extends le{constructor(e){super(),ie(this,e,Qt,Ut,ae,{data:5,hoverable:0,highlightedElement:6})}}function Xe(s,e,t){const n=s.slice();return n[28]=e[t],n}function Re(s){let e,t;function n(){return s[14](s[28])}return e=new tt({props:{type:"output",componentName:s[0].name,elementName:s[28]}}),e.$on("mouseenter",n),e.$on("mouseleave",s[15]),{c(){W(e.$$.fragment)},l(r){q(e.$$.fragment,r)},m(r,o){F(e,r,o),t=!0},p(r,o){s=r;const a={};o&1&&(a.componentName=s[0].name),o&1&&(a.elementName=s[28]),e.$set(a)},i(r){t||(O(e.$$.fragment,r),t=!0)},o(r){J(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function xt(s){let e,t,n,r,o,a=Ce(s[0].name,32)+"",i,d,v,m='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 svelte-1c9keib"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"></path></svg>',b,_,c,g,f,y,S,j,M;n=new nt({props:{data:s[0],hoverable:s[2],highlightedElement:s[3]}}),g=new tt({props:{type:"input",componentName:s[0].name,elementName:s[0].elements[0].name}}),g.$on("mouseenter",s[12]),g.$on("mouseleave",s[13]);let I=he(Be(s[0].elements)),H=[];for(let l=0;l<I.length;l+=1)H[l]=Re(Xe(s,I,l));const E=l=>J(H[l],1,1,()=>{H[l]=null});return{c(){e=B("div"),t=B("div"),W(n.$$.fragment),r=G(),o=B("p"),i=se(a),d=G(),v=B("button"),v.innerHTML=m,_=G(),c=B("div"),W(g.$$.fragment),f=G(),y=B("div");for(let l=0;l<H.length;l+=1)H[l].c();this.h()},l(l){e=P(l,"DIV",{class:!0});var w=Y(e);t=P(w,"DIV",{class:!0});var h=Y(t);q(n.$$.fragment,h),h.forEach(k),r=Z(w),o=P(w,"P",{class:!0});var D=Y(o);i=oe(D,a),D.forEach(k),d=Z(w),v=P(w,"BUTTON",{class:!0,"data-svelte-h":!0}),ce(v)!=="svelte-1i5wmoe"&&(v.innerHTML=m),w.forEach(k),_=Z(l),c=P(l,"DIV",{class:!0});var C=Y(c);q(g.$$.fragment,C),C.forEach(k),f=Z(l),y=P(l,"DIV",{class:!0});var T=Y(y);for(let X=0;X<H.length;X+=1)H[X].l(T);T.forEach(k),this.h()},h(){p(t,"class","img-cont svelte-1c9keib"),p(o,"class","svelte-1c9keib"),p(v,"class","remove-button svelte-1c9keib"),p(e,"class",b="main-component-node "+(s[1]?"hover":"")+" "+(s[2]?"selected":"")+" svelte-1c9keib"),p(c,"class","handle-wrapper left svelte-1c9keib"),p(y,"class","handle-wrapper right svelte-1c9keib")},m(l,w){V(l,e,w),$(e,t),F(n,t,null),$(e,r),$(e,o),$(o,i),$(e,d),$(e,v),V(l,_,w),V(l,c,w),F(g,c,null),V(l,f,w),V(l,y,w);for(let h=0;h<H.length;h+=1)H[h]&&H[h].m(y,null);S=!0,j||(M=[U(v,"click",s[5]),U(e,"mouseenter",s[9]),U(e,"mouseleave",s[10]),U(e,"pointerdown",s[11]),U(e,"click",s[6])],j=!0)},p(l,[w]){const h={};w&1&&(h.data=l[0]),w&4&&(h.hoverable=l[2]),w&8&&(h.highlightedElement=l[3]),n.$set(h),(!S||w&1)&&a!==(a=Ce(l[0].name,32)+"")&&ye(i,a),(!S||w&6&&b!==(b="main-component-node "+(l[1]?"hover":"")+" "+(l[2]?"selected":"")+" svelte-1c9keib"))&&p(e,"class",b);const D={};if(w&1&&(D.componentName=l[0].name),w&1&&(D.elementName=l[0].elements[0].name),g.$set(D),w&9){I=he(Be(l[0].elements));let C;for(C=0;C<I.length;C+=1){const T=Xe(l,I,C);H[C]?(H[C].p(T,w),O(H[C],1)):(H[C]=Re(T),H[C].c(),O(H[C],1),H[C].m(y,null))}for(De(),C=I.length;C<H.length;C+=1)E(C);Ne()}},i(l){if(!S){O(n.$$.fragment,l),O(g.$$.fragment,l);for(let w=0;w<I.length;w+=1)O(H[w]);S=!0}},o(l){J(n.$$.fragment,l),J(g.$$.fragment,l),H=H.filter(Boolean);for(let w=0;w<H.length;w+=1)J(H[w]);S=!1},d(l){l&&(k(e),k(_),k(c),k(f),k(y)),K(n),K(g),Ke(H,l),j=!1,de(M)}}}function en(s,e,t){const n=["data","parentId","id"];pe(e,n);let r,o;re(s,$e,u=>t(19,r=u)),re(s,x,u=>t(20,o=u));let{data:a}=e,{parentId:i}=e,{id:d}=e,v=!1,m=!1,b=null;const _=()=>{x.update(u=>{const L={...u};return L.json.components=L.json.components.filter(R=>R.name!==d),L.json.structure=L.json.structure.filter(R=>!R.some(z=>z.startsWith(d))),L})},c=()=>{if(t(2,m=!0),$e){let[u,L]=Et(o.json,"components","name",d);r(u,L)}},g=()=>{v||(t(2,m=!1),r(-1,-1))};let f=!1;const{getNode:y,updateNode:S,getZoom:j}=Ue();let M,I=-1,H=-1;const E=()=>{I=-1,H=-1},l=u=>{if(I!==-1&&M){const L=(u.clientX-I)/j(),R=(u.clientY-H)/j();S(i,{position:{x:M.position.x+L,y:M.position.y+R}})}I=u.clientX,H=u.clientY};ke(()=>{document.addEventListener("pointerdown",g),window.addEventListener("wheel",()=>{E()}),window.addEventListener("pointerup",()=>{t(4,f=!1),E()}),window.addEventListener("pointermove",u=>{f&&l(u)}),window.addEventListener("keydown",u=>{m&&(u.key==="Delete"||u.key==="Backspace")&&(t(2,m=!1),r(-1,-1),_())})});const w=()=>t(1,v=!0),h=()=>t(1,v=!1),D=()=>t(4,f=!0),C=()=>t(3,b=a.elements[0].name),T=()=>t(3,b=null),X=u=>t(3,b=u),A=()=>t(3,b=null);return s.$$set=u=>{e=ge(ge({},e),je(u)),t(27,pe(e,n)),"data"in u&&t(0,a=u.data),"parentId"in u&&t(7,i=u.parentId),"id"in u&&t(8,d=u.id)},s.$$.update=()=>{s.$$.dirty&128&&(M=y(i))},[a,v,m,b,f,_,c,i,d,w,h,D,C,T,X,A]}class tn extends le{constructor(e){super(),ie(this,e,en,xt,ae,{data:0,parentId:7,id:8})}}function nn(s){let e,t='<h1 class="svelte-px3r3z">System is Empty</h1> <p class="svelte-px3r3z">Drag and Drop Components from Sidebar.</p>';return{c(){e=B("div"),e.innerHTML=t,this.h()},l(n){e=P(n,"DIV",{class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-18766g4"&&(e.innerHTML=t),this.h()},h(){p(e,"class","node-cont svelte-px3r3z")},m(n,r){V(n,e,r)},p:te,i:te,o:te,d(n){n&&k(e)}}}function sn(s,e,t){const n=[];return pe(e,n),s.$$set=r=>{e=ge(ge({},e),je(r)),t(0,pe(e,n))},[]}class on extends le{constructor(e){super(),ie(this,e,sn,nn,ae,{})}}function rn(s){let e,t="",n=`translate(-50%, -50%) translate(${s[8]}px,${s[7]}px)`,r=`${Math.abs(s[0]-s[2])}px`,o=`${Math.abs(s[1]-s[3])}px`,a,i,d,v,m,b,_=`translate(-50%, -50%) translate(${s[8]}px,${s[7]}px)`,c,g;return{c(){e=B("div"),e.innerHTML=t,a=G(),i=B("div"),d=B("button"),v=ve("svg"),m=ve("path"),this.h()},l(f){e=P(f,"DIV",{class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-1ju4ft1"&&(e.innerHTML=t),a=Z(f),i=P(f,"DIV",{class:!0});var y=Y(i);d=P(y,"BUTTON",{class:!0});var S=Y(d);v=we(S,"svg",{xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0,class:!0});var j=Y(v);m=we(j,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),Y(m).forEach(k),j.forEach(k),S.forEach(k),y.forEach(k),this.h()},h(){p(e,"class","hover-helper nodrag nopan svelte-o5z5zp"),ee(e,"transform",n),ee(e,"width",r),ee(e,"height",o),p(m,"stroke-linecap","round"),p(m,"stroke-linejoin","round"),p(m,"d","M6 18 18 6M6 6l12 12"),p(v,"xmlns","http://www.w3.org/2000/svg"),p(v,"fill","none"),p(v,"viewBox","0 0 24 24"),p(v,"stroke-width","1.5"),p(v,"stroke","currentColor"),p(v,"class","size-6 svelte-o5z5zp"),p(d,"class",b="edgeButton "+(s[6]?"hover":"")+" svelte-o5z5zp"),p(i,"class","edgeButtonContainer nodrag nopan svelte-o5z5zp"),ee(i,"transform",_)},m(f,y){V(f,e,y),V(f,a,y),V(f,i,y),$(i,d),$(d,v),$(v,m),c||(g=[U(e,"mouseenter",s[15]),U(e,"mouseleave",s[16]),U(d,"click",s[10]),U(i,"mouseenter",s[17]),U(i,"mouseleave",s[18])],c=!0)},p(f,y){y&384&&n!==(n=`translate(-50%, -50%) translate(${f[8]}px,${f[7]}px)`)&&ee(e,"transform",n),y&5&&r!==(r=`${Math.abs(f[0]-f[2])}px`)&&ee(e,"width",r),y&10&&o!==(o=`${Math.abs(f[1]-f[3])}px`)&&ee(e,"height",o),y&64&&b!==(b="edgeButton "+(f[6]?"hover":"")+" svelte-o5z5zp")&&p(d,"class",b),y&384&&_!==(_=`translate(-50%, -50%) translate(${f[8]}px,${f[7]}px)`)&&ee(i,"transform",_)},d(f){f&&(k(e),k(a),k(i)),c=!1,de(g)}}}function an(s){let e,t,n,r;return e=new ct({props:{path:s[9],markerEnd:s[4],style:s[5]}}),n=new mt({props:{$$slots:{default:[rn]},$$scope:{ctx:s}}}),{c(){W(e.$$.fragment),t=G(),W(n.$$.fragment)},l(o){q(e.$$.fragment,o),t=Z(o),q(n.$$.fragment,o)},m(o,a){F(e,o,a),V(o,t,a),F(n,o,a),r=!0},p(o,[a]){const i={};a&512&&(i.path=o[9]),a&16&&(i.markerEnd=o[4]),a&32&&(i.style=o[5]),e.$set(i);const d={};a&1049039&&(d.$$scope={dirty:a,ctx:o}),n.$set(d)},i(o){r||(O(e.$$.fragment,o),O(n.$$.fragment,o),r=!0)},o(o){J(e.$$.fragment,o),J(n.$$.fragment,o),r=!1},d(o){o&&k(t),K(e,o),K(n,o)}}}function ln(s,e,t){let n,r,o;const a=["sourceX","sourceY","sourcePosition","targetX","targetY","targetPosition","markerEnd","style","sourceHandleId","targetHandleId"];pe(e,a);let{sourceX:i}=e,{sourceY:d}=e,{sourcePosition:v}=e,{targetX:m}=e,{targetY:b}=e,{targetPosition:_}=e,{markerEnd:c=void 0}=e,{style:g=void 0}=e,{sourceHandleId:f=null}=e,{targetHandleId:y=null}=e;const S=()=>{x.update(l=>{const w={...l};return w.json.structure=w.json.structure.filter(h=>h[0]!==f&&h[1]!==y),w})};let j=!1;const M=()=>{t(6,j=!0)},I=()=>{t(6,j=!1)},H=()=>{t(6,j=!0)},E=()=>{t(6,j=!1)};return s.$$set=l=>{e=ge(ge({},e),je(l)),t(19,pe(e,a)),"sourceX"in l&&t(0,i=l.sourceX),"sourceY"in l&&t(1,d=l.sourceY),"sourcePosition"in l&&t(11,v=l.sourcePosition),"targetX"in l&&t(2,m=l.targetX),"targetY"in l&&t(3,b=l.targetY),"targetPosition"in l&&t(12,_=l.targetPosition),"markerEnd"in l&&t(4,c=l.markerEnd),"style"in l&&t(5,g=l.style),"sourceHandleId"in l&&t(13,f=l.sourceHandleId),"targetHandleId"in l&&t(14,y=l.targetHandleId)},s.$$.update=()=>{s.$$.dirty&6159&&t(9,[n,r,o]=ft({sourceX:i,sourceY:d,sourcePosition:v,targetX:m,targetY:b,targetPosition:_}),n,(t(8,r),t(0,i),t(1,d),t(11,v),t(2,m),t(3,b),t(12,_)),(t(7,o),t(0,i),t(1,d),t(11,v),t(2,m),t(3,b),t(12,_)))},[i,d,m,b,c,g,j,o,r,n,S,v,_,f,y,M,I,H,E]}class un extends le{constructor(e){super(),ie(this,e,ln,an,ae,{sourceX:0,sourceY:1,sourcePosition:11,targetX:2,targetY:3,targetPosition:12,markerEnd:4,style:5,sourceHandleId:13,targetHandleId:14})}}function cn(s){let e,t,n,r;return e=new pt({}),n=new gt({props:{bgColor:"rgb(245,245,245)",variant:vt.Dots,gap:54,size:2}}),{c(){W(e.$$.fragment),t=G(),W(n.$$.fragment)},l(o){q(e.$$.fragment,o),t=Z(o),q(n.$$.fragment,o)},m(o,a){F(e,o,a),V(o,t,a),F(n,o,a),r=!0},p:te,i(o){r||(O(e.$$.fragment,o),O(n.$$.fragment,o),r=!0)},o(o){J(e.$$.fragment,o),J(n.$$.fragment,o),r=!1},d(o){o&&k(t),K(e,o),K(n,o)}}}function mn(s){let e,t;return e=new dt({props:{minZoom:.3,maxZoom:1,nodeTypes:s[0],edgeTypes:s[1],nodes:s[2],edges:s[3],fitView:!0,connectionLineType:ht.SmoothStep,isValidConnection:s[7],onconnect:s[6],deleteKey:null,defaultEdgeOptions:{animated:!0,deletable:!0},$$slots:{default:[cn]},$$scope:{ctx:s}}}),e.$on("dragover",s[4]),e.$on("drop",s[5]),{c(){W(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){F(e,n,r),t=!0},p(n,[r]){const o={};r&1024&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){K(e,n)}}}function fn(s,e,t){let n;re(s,x,c=>t(8,n=c));const r={component:tn,empty:on},o={default:un},a=Te([]),i=Te([]);x.subscribe(c=>{St(a,i)});const d=c=>{c.preventDefault(),c.dataTransfer&&(c.dataTransfer.dropEffect="move")},{screenToFlowPosition:v}=Ue(),m=c=>{if(c.preventDefault(),!c.dataTransfer)return null;let g;try{g=JSON.parse(c.dataTransfer.getData("application/svelteflow"))}catch(y){console.error("Error parsing component data",y);return}g.name=xe(g.name,n.json.components),x.update(y=>{const S={...y};return S.json.components.push(g),S});const f=v({x:c.clientX,y:c.clientY});f.y-=100,f.x+=100,a.update(y=>{const S=y.find(j=>j.id=`group.${g.name}`);return S&&(S.position=f),y})};return a.subscribe(c=>{c.length===0?a.set([{id:"1",type:"empty",draggable:!1,position:{x:0,y:150},data:{},origin:[.5,.5]}]):c.some(g=>g.type==="empty")&&c.length>1&&a.set(c.filter(g=>g.type!=="empty"))}),[r,o,a,i,d,m,c=>{!c.sourceHandle||!c.targetHandle||x.update(g=>{const f={...g};return f.json.structure=f.json.structure.filter(y=>y[0]!==c.sourceHandle&&y[1]!==c.targetHandle),f.json.structure.push([c.sourceHandle,c.targetHandle]),f})},c=>{var j,M;if(!c.sourceHandle||!c.targetHandle)return!1;const g=["ShaftDiscrete","ShaftContinuous"],f=(j=Pe(c.sourceHandle))==null?void 0:j.type,y=(M=Pe(c.targetHandle))==null?void 0:M.type;let S=!0;return g.includes(f)&&!(y==="Disk"||y==="GearElement")&&(S=!1),f==="Disk"&&!(g.includes(y)||y==="Disk")&&(S=!1),f==="GearElement"&&!g.includes(y)&&(S=!1),It([...n.json.structure,[c.sourceHandle,c.targetHandle]])||(S=!1),S}]}class dn extends le{constructor(e){super(),ie(this,e,fn,mn,ae,{})}}function hn(s){let e,t,n;return{c(){e=se(`Add\r
                `),t=ve("svg"),n=ve("path"),this.h()},l(r){e=oe(r,`Add\r
                `),t=we(r,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=Y(t);n=we(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),Y(n).forEach(k),o.forEach(k),this.h()},h(){p(n,"stroke-linecap","round"),p(n,"stroke-linejoin","round"),p(n,"d","M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"),p(t,"class","add-icon svelte-7cbgx7"),p(t,"xmlns","http://www.w3.org/2000/svg"),p(t,"fill","none"),p(t,"viewBox","0 0 24 24"),p(t,"stroke-width","1.5"),p(t,"stroke","currentColor")},m(r,o){V(r,e,o),V(r,t,o),$(t,n)},p:te,d(r){r&&(k(e),k(t))}}}function pn(s){let e,t,n,r,o,a,i,d,v=Ce(s[0].name,19)+"",m,b,_,c,g,f=s[1]?"Custom Component":"Generic Component",y,S,j,M,I,H,E,l,w,h;n=new nt({props:{data:s[0],hoverable:!1}}),_=new Wt({props:{options:s[1]?["Duplicate","Edit","Delete"]:["Duplicate"],optionIcons:['<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 8.25V6a2.25 2.25 0 0 0-2.25-2.25H6A2.25 2.25 0 0 0 3.75 6v8.25A2.25 2.25 0 0 0 6 16.5h2.25m8.25-8.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-7.5A2.25 2.25 0 0 1 8.25 18v-1.5m8.25-8.25h-6a2.25 2.25 0 0 0-2.25 2.25v6" /></svg>','<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" /></svg>','<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0" /></svg>'],onClick:s[6]}}),M=new Me({props:{onClick:s[5],color:"rgb(30, 30, 30)",$$slots:{default:[hn]},$$scope:{ctx:s}}});let D={};return E=new et({props:D}),s[10](E),{c(){e=B("div"),t=B("div"),W(n.$$.fragment),r=G(),o=B("div"),a=B("div"),i=B("h4"),d=B("span"),m=se(v),b=G(),W(_.$$.fragment),c=G(),g=B("p"),y=se(f),S=G(),j=B("div"),W(M.$$.fragment),H=G(),W(E.$$.fragment),this.h()},l(C){e=P(C,"DIV",{class:!0,draggable:!0});var T=Y(e);t=P(T,"DIV",{class:!0});var X=Y(t);q(n.$$.fragment,X),X.forEach(k),r=Z(T),o=P(T,"DIV",{class:!0});var A=Y(o);a=P(A,"DIV",{});var u=Y(a);i=P(u,"H4",{class:!0});var L=Y(i);d=P(L,"SPAN",{class:!0});var R=Y(d);m=oe(R,v),R.forEach(k),b=Z(L),q(_.$$.fragment,L),L.forEach(k),c=Z(u),g=P(u,"P",{class:!0});var z=Y(g);y=oe(z,f),z.forEach(k),u.forEach(k),S=Z(A),j=P(A,"DIV",{});var Q=Y(j);q(M.$$.fragment,Q),Q.forEach(k),A.forEach(k),T.forEach(k),H=Z(C),q(E.$$.fragment,C),this.h()},h(){p(t,"class","illustration-cont svelte-7cbgx7"),p(d,"class","comp-name svelte-7cbgx7"),p(i,"class","svelte-7cbgx7"),p(g,"class","svelte-7cbgx7"),p(o,"class","component-info svelte-7cbgx7"),p(e,"class",I="component-list-item "+(s[3]?"hover":"")+" svelte-7cbgx7"),p(e,"draggable",!0)},m(C,T){V(C,e,T),$(e,t),F(n,t,null),$(e,r),$(e,o),$(o,a),$(a,i),$(i,d),$(d,m),$(i,b),F(_,i,null),$(a,c),$(a,g),$(g,y),$(o,S),$(o,j),F(M,j,null),V(C,H,T),F(E,C,T),l=!0,w||(h=[U(e,"mouseenter",s[7]),U(e,"mouseleave",s[8]),U(e,"dragstart",s[9])],w=!0)},p(C,[T]){const X={};T&1&&(X.data=C[0]),n.$set(X),(!l||T&1)&&v!==(v=Ce(C[0].name,19)+"")&&ye(m,v);const A={};T&2&&(A.options=C[1]?["Duplicate","Edit","Delete"]:["Duplicate"]),_.$set(A),(!l||T&2)&&f!==(f=C[1]?"Custom Component":"Generic Component")&&ye(y,f);const u={};T&4096&&(u.$$scope={dirty:T,ctx:C}),M.$set(u),(!l||T&8&&I!==(I="component-list-item "+(C[3]?"hover":"")+" svelte-7cbgx7"))&&p(e,"class",I);const L={};E.$set(L)},i(C){l||(O(n.$$.fragment,C),O(_.$$.fragment,C),O(M.$$.fragment,C),O(E.$$.fragment,C),l=!0)},o(C){J(n.$$.fragment,C),J(_.$$.fragment,C),J(M.$$.fragment,C),J(E.$$.fragment,C),l=!1},d(C){C&&(k(e),k(H)),K(n),K(_),K(M),s[10](null),K(E,C),w=!1,de(h)}}}function gn(s,e,t){let n;re(s,x,f=>t(11,n=f));let r,{data:o}=e,{id:a=""}=e;const i=f=>{if(!f.dataTransfer)return null;f.dataTransfer.setData("application/svelteflow",JSON.stringify(o)),f.dataTransfer.effectAllowed="move"},d=()=>{const f={...o};f.name=xe(f.name,n.json.components),x.update(y=>{const S={...y};return S.json.components.push(f),S}),Dt(f)};let v=!1;const m=f=>{f==="Duplicate"?Nt({...o,name:`Copy of ${o.name}`},!0):f==="Edit"?ne(`/component-editor/${a}`):f==="Delete"&&r.openDialog(`Are you sure you want to delete ${o.name} component?`,"Yes","No").then(y=>{y&&$t(a)})},b=()=>{t(3,v=!0)},_=()=>{t(3,v=!1)},c=f=>i(f);function g(f){ue[f?"unshift":"push"](()=>{r=f,t(2,r)})}return s.$$set=f=>{"data"in f&&t(0,o=f.data),"id"in f&&t(1,a=f.id)},[o,a,r,v,i,d,m,b,_,c,g]}class st extends le{constructor(e){super(),ie(this,e,gn,pn,ae,{data:0,id:1})}}const Ge=[{name:"Windmill Turbine",json:{name:"Windmill Turbine",elements:[{name:"Disk 1",type:"Disk",inertia:92e5,damping:0}]}},{name:"Windmill Rotor",json:{name:"Windmill Rotor",elements:[{name:"Disk 1",type:"Disk",inertia:3430,damping:1},{name:"Shaft 1",type:"ShaftDiscrete",stiffness:555e7,damping:0},{name:"Disk 2",type:"Disk",inertia:95200,damping:0,excitation:{type:"excitationValuesRpmPercentage",values:[[4,.001466],[6,.02026],[8,.002442],[10,.003751],[12,.01392],[14,.001561],[16,.001928]]}}]}},{name:"Shaft",json:{name:"Shaft",elements:[{name:"Shaft 1",type:"ShaftDiscrete",damping:0,stiffness:368e6}]}}];function Ze(s,e,t){const n=s.slice();return n[7]=e[t],n}function We(s,e,t){const n=s.slice();return n[10]=e[t][0],n[7]=e[t][1],n}function vn(s){let e;return{c(){e=se("New Component")},l(t){e=oe(t,"New Component")},m(t,n){V(t,e,n)},d(t){t&&k(e)}}}function qe(s,e){let t,n,r;return n=new st({props:{id:e[10],data:e[7]}}),{key:s,first:null,c(){t=ze(),W(n.$$.fragment),this.h()},l(o){t=ze(),q(n.$$.fragment,o),this.h()},h(){this.first=t},m(o,a){V(o,t,a),F(n,o,a),r=!0},p(o,a){e=o;const i={};a&2&&(i.id=e[10]),a&2&&(i.data=e[7]),n.$set(i)},i(o){r||(O(n.$$.fragment,o),r=!0)},o(o){J(n.$$.fragment,o),r=!1},d(o){o&&k(t),K(n,o)}}}function Fe(s){let e,t;return e=new st({props:{data:s[2](s[7].json)}}),{c(){W(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){F(e,n,r),t=!0},p:te,i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){K(e,n)}}}function wn(s){let e,t,n,r="Components:",o,a,i,d,v,m,b=[],_=new Map,c,g,f,y;a=new Qe({props:{isActive:!0,lightMode:!0,icon:'<svg class="icon-create" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>',options:["Create New","Import New"],optionIcons:['<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" /></svg>','<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" /></svg>'],onClick:s[3],$$slots:{default:[vn]},$$scope:{ctx:s}}});let S=he(s[1]);const j=E=>E[10];for(let E=0;E<S.length;E+=1){let l=We(s,S,E),w=j(l);_.set(w,b[E]=qe(w,l))}let M=he(Ge),I=[];for(let E=0;E<M.length;E+=1)I[E]=Fe(Ze(s,M,E));const H=E=>J(I[E],1,1,()=>{I[E]=null});return{c(){e=B("div"),t=B("div"),n=B("h3"),n.textContent=r,o=G(),W(a.$$.fragment),i=G(),d=B("input"),v=G(),m=B("div");for(let E=0;E<b.length;E+=1)b[E].c();c=G();for(let E=0;E<I.length;E+=1)I[E].c();this.h()},l(E){e=P(E,"DIV",{class:!0});var l=Y(e);t=P(l,"DIV",{class:!0});var w=Y(t);n=P(w,"H3",{class:!0,"data-svelte-h":!0}),ce(n)!=="svelte-178s5hg"&&(n.textContent=r),o=Z(w),q(a.$$.fragment,w),i=Z(w),d=P(w,"INPUT",{type:!0,class:!0,name:!0,accept:!0}),w.forEach(k),v=Z(l),m=P(l,"DIV",{class:!0});var h=Y(m);for(let D=0;D<b.length;D+=1)b[D].l(h);c=Z(h);for(let D=0;D<I.length;D+=1)I[D].l(h);h.forEach(k),l.forEach(k),this.h()},h(){p(n,"class","svelte-1974053"),p(d,"type","file"),p(d,"class","hidden svelte-1974053"),p(d,"name","component-file"),p(d,"accept",".json"),p(t,"class","component-upper svelte-1974053"),p(m,"class","component-list svelte-1974053"),p(e,"class","component-cont svelte-1974053")},m(E,l){V(E,e,l),$(e,t),$(t,n),$(t,o),F(a,t,null),$(t,i),$(t,d),s[4](d),$(e,v),$(e,m);for(let w=0;w<b.length;w+=1)b[w]&&b[w].m(m,null);$(m,c);for(let w=0;w<I.length;w+=1)I[w]&&I[w].m(m,null);g=!0,f||(y=U(d,"change",jt),f=!0)},p(E,[l]){const w={};if(l&8192&&(w.$$scope={dirty:l,ctx:E}),a.$set(w),l&2&&(S=he(E[1]),De(),b=yt(b,l,j,1,E,S,_,m,Ct,qe,c,We),Ne()),l&4){M=he(Ge);let h;for(h=0;h<M.length;h+=1){const D=Ze(E,M,h);I[h]?(I[h].p(D,l),O(I[h],1)):(I[h]=Fe(D),I[h].c(),O(I[h],1),I[h].m(m,null))}for(De(),h=M.length;h<I.length;h+=1)H(h);Ne()}},i(E){if(!g){O(a.$$.fragment,E);for(let l=0;l<S.length;l+=1)O(b[l]);for(let l=0;l<M.length;l+=1)O(I[l]);g=!0}},o(E){J(a.$$.fragment,E);for(let l=0;l<b.length;l+=1)J(b[l]);I=I.filter(Boolean);for(let l=0;l<I.length;l+=1)J(I[l]);g=!1},d(E){E&&k(e),K(a),s[4](null);for(let l=0;l<b.length;l+=1)b[l].d();Ke(I,E),f=!1,y()}}}function _n(s,e,t){let n,r;re(s,x,m=>t(5,n=m)),re(s,Ve,m=>t(6,r=m));const o=m=>m;let a,i=Array.from(r.entries()).filter(([m,b])=>m.startsWith(`${n.id}-`)).reverse();Ve.subscribe(m=>{t(1,i=Array.from(m.entries()).filter(([b,_])=>b.startsWith(`${n.id}-`)).reverse())});const d=m=>{m==="Create New"?ne("/component-editor"):m==="Import New"&&a.click()};function v(m){ue[m?"unshift":"push"](()=>{a=m,t(0,a)})}return[a,i,o,d,v]}class kn extends le{constructor(e){super(),ie(this,e,_n,wn,ae,{})}}function bn(s){let e,t;return e=new dn({}),{c(){W(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){F(e,n,r),t=!0},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){K(e,n)}}}function yn(s){let e,t,n;return{c(){e=se(`Analyze System\r
                `),t=ve("svg"),n=ve("path"),this.h()},l(r){e=oe(r,`Analyze System\r
                `),t=we(r,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0,"stroke-width":!0,stroke:!0});var o=Y(t);n=we(o,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,d:!0}),Y(n).forEach(k),o.forEach(k),this.h()},h(){p(n,"stroke-linecap","round"),p(n,"stroke-linejoin","round"),p(n,"d","M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"),p(t,"class","icon-analyze svelte-1aha82o"),p(t,"xmlns","http://www.w3.org/2000/svg"),p(t,"fill","none"),p(t,"viewBox","0 0 24 24"),p(t,"stroke-width","1.5"),p(t,"stroke","currentColor")},m(r,o){V(r,e,o),V(r,t,o),$(t,n)},p:te,d(r){r&&(k(e),k(t))}}}function Cn(s){let e,t=`<svg class="icon-back svelte-1aha82o" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg>              
                Back`,n,r,o="Import",a,i,d,v,m="Analysis",b,_;return{c(){e=B("span"),e.innerHTML=t,n=G(),r=B("span"),r.textContent=o,a=G(),i=B("input"),d=G(),v=B("span"),v.textContent=m,this.h()},l(c){e=P(c,"SPAN",{class:!0,"data-svelte-h":!0}),ce(e)!=="svelte-j1q8i7"&&(e.innerHTML=t),n=Z(c),r=P(c,"SPAN",{class:!0,"data-svelte-h":!0}),ce(r)!=="svelte-t65nu0"&&(r.textContent=o),a=Z(c),i=P(c,"INPUT",{type:!0,class:!0,name:!0,accept:!0}),d=Z(c),v=P(c,"SPAN",{class:!0,"data-svelte-h":!0}),ce(v)!=="svelte-1e3iin2"&&(v.textContent=m),this.h()},h(){p(e,"class","link-element svelte-1aha82o"),p(r,"class","link-element import-btn svelte-1aha82o"),p(i,"type","file"),p(i,"class","hidden svelte-1aha82o"),p(i,"name","file"),p(i,"accept",".json"),p(v,"class","link-element svelte-1aha82o")},m(c,g){V(c,e,g),V(c,n,g),V(c,r,g),V(c,a,g),V(c,i,g),s[29](i),V(c,d,g),V(c,v,g),b||(_=[U(e,"click",s[14]),U(r,"click",s[28]),U(i,"change",s[30]),U(v,"click",s[16])],b=!0)},p:te,d(c){c&&(k(e),k(n),k(r),k(a),k(i),k(d),k(v)),s[29](null),b=!1,de(_)}}}function En(s){let e,t;return e=new bt({props:{text:"System",value:s[5],isError:s[1],onInput:s[27]}}),{c(){W(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){F(e,n,r),t=!0},p(n,r){const o={};r[0]&32&&(o.value=n[5]),r[0]&2&&(o.isError=n[1]),r[0]&4098&&(o.onInput=n[27]),e.$set(o)},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){K(e,n)}}}function Sn(s){let e;return{c(){e=se("Export")},l(t){e=oe(t,"Export")},m(t,n){V(t,e,n)},d(t){t&&k(e)}}}function In(s){let e;return{c(){e=se("Save")},l(t){e=oe(t,"Save")},m(t,n){V(t,e,n)},d(t){t&&k(e)}}}function Dn(s){let e,t,n,r;return e=new Qe({props:{isActive:!(s[0]||s[1]||s[2]),onClick:s[26],icon:'<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" /></svg>',options:["Download JSON"],optionIcons:['<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>'],$$slots:{default:[Sn]},$$scope:{ctx:s}}}),n=new Me({props:{isActive:!(s[0]||s[1]||s[2]),icon:'<svg class="icon-save" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" /></svg>',onClick:s[15],$$slots:{default:[In]},$$scope:{ctx:s}}}),{c(){W(e.$$.fragment),t=G(),W(n.$$.fragment)},l(o){q(e.$$.fragment,o),t=Z(o),q(n.$$.fragment,o)},m(o,a){F(e,o,a),V(o,t,a),F(n,o,a),r=!0},p(o,a){const i={};a[0]&7&&(i.isActive=!(o[0]||o[1]||o[2])),a[0]&4096&&(i.onClick=o[26]),a[1]&8&&(i.$$scope={dirty:a,ctx:o}),e.$set(i);const d={};a[0]&7&&(d.isActive=!(o[0]||o[1]||o[2])),a[1]&8&&(d.$$scope={dirty:a,ctx:o}),n.$set(d)},i(o){r||(O(e.$$.fragment,o),O(n.$$.fragment,o),r=!0)},o(o){J(e.$$.fragment,o),J(n.$$.fragment,o),r=!1},d(o){o&&k(t),K(e,o),K(n,o)}}}function Nn(s){let e,t;return e=new kn({}),{c(){W(e.$$.fragment)},l(n){q(e.$$.fragment,n)},m(n,r){F(e,n,r),t=!0},i(n){t||(O(e.$$.fragment,n),t=!0)},o(n){J(e.$$.fragment,n),t=!1},d(n){K(e,n)}}}function $n(s){let e,t,n,r,o,a,i,d,v,m,b,_="",c,g,f,y,S,j,M,I,H,E,l,w,h,D,C;d=new wt({props:{$$slots:{default:[bn]},$$scope:{ctx:s}}});function T(u){s[22](u)}let X={onInput:s[20]};s[6]!==void 0&&(X.textContent=s[6]),g=new _t({props:X}),s[21](g),ue.push(()=>it(g,"textContent",T)),j=new Me({props:{lightMode:!0,color:"var(--main-dark-color)",isActive:!(s[0]||s[1]||s[2]),onClick:s[16],icon:`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9.75 3.104v5.714a2.25 2.25 0 0 1-.659 1.591L5 14.5M9.75 3.104c-.251.023-.501.05-.75.082m.75-.082a24.301 24.301 0 0 1 4.5 0m0 0v5.714c0 .597.237 1.17.659 1.591L19.8 15.3M14.25 3.104c.251.023.501.05.75.082M19.8 15.3l-1.57.393A9.065 9.065 0 0 1 12 15a9.065 9.065 0 0 0-6.23-.693L5 14.5m14.8.8 1.402 1.402c1.232 1.232.65 3.318-1.067 3.611A48.309 48.309 0 0 1 12 21c-2.773 0-5.491-.235-8.135-.687-1.718-.293-2.3-2.379-1.067-3.61L5 14.5" />
                    </svg>`,$$slots:{default:[yn]},$$scope:{ctx:s}}}),I=new kt({props:{$$slots:{buttons:[Dn],name:[En],links:[Cn]},$$scope:{ctx:s}}}),E=new Zt({props:{$$slots:{default:[Nn]},$$scope:{ctx:s}}});let A={};return w=new et({props:A}),s[31](w),{c(){e=B("link"),t=B("link"),n=B("link"),r=G(),o=B("div"),a=B("div"),i=B("div"),W(d.$$.fragment),v=G(),m=B("div"),b=B("div"),b.innerHTML=_,c=G(),W(g.$$.fragment),y=G(),S=B("div"),W(j.$$.fragment),M=G(),W(I.$$.fragment),H=G(),W(E.$$.fragment),l=G(),W(w.$$.fragment),this.h()},l(u){const L=at("svelte-1k4ajvi",document.head);e=P(L,"LINK",{rel:!0,href:!0}),t=P(L,"LINK",{rel:!0,href:!0,crossorigin:!0}),n=P(L,"LINK",{href:!0,rel:!0}),L.forEach(k),r=Z(u),o=P(u,"DIV",{class:!0});var R=Y(o);a=P(R,"DIV",{class:!0,style:!0});var z=Y(a);i=P(z,"DIV",{class:!0});var Q=Y(i);q(d.$$.fragment,Q),Q.forEach(k),v=Z(z),m=P(z,"DIV",{class:!0});var N=Y(m);b=P(N,"DIV",{class:!0,"data-svelte-h":!0}),ce(b)!=="svelte-ifq5cp"&&(b.innerHTML=_),c=Z(N),q(g.$$.fragment,N),N.forEach(k),y=Z(z),S=P(z,"DIV",{class:!0});var me=Y(S);q(j.$$.fragment,me),me.forEach(k),z.forEach(k),M=Z(R),q(I.$$.fragment,R),H=Z(R),q(E.$$.fragment,R),R.forEach(k),l=Z(u),q(w.$$.fragment,u),this.h()},h(){p(e,"rel","preconnect"),p(e,"href","https://fonts.googleapis.com"),p(t,"rel","preconnect"),p(t,"href","https://fonts.gstatic.com"),p(t,"crossorigin","true"),p(n,"href","https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap"),p(n,"rel","stylesheet"),document.title="System Editor | OpenTorsion Editor",p(i,"class","flow-editor svelte-1aha82o"),p(b,"class","resize-slider svelte-1aha82o"),p(m,"class","json-editor svelte-1aha82o"),p(S,"class","analyze-btn-cont svelte-1aha82o"),p(a,"class","main-editor-area svelte-1aha82o"),ee(a,"--json-editor-height",s[8]),ee(a,"--flow-editor-height",s[11]),p(o,"class","main-screen svelte-1aha82o")},m(u,L){$(document.head,e),$(document.head,t),$(document.head,n),V(u,r,L),V(u,o,L),$(o,a),$(a,i),F(d,i,null),$(a,v),$(a,m),$(m,b),$(m,c),F(g,m,null),s[23](m),$(a,y),$(a,S),F(j,S,null),$(o,M),F(I,o,null),$(o,H),F(E,o,null),V(u,l,L),F(w,u,L),h=!0,D||(C=[U(b,"mousedown",s[19]),U(a,"mouseup",s[24]),U(a,"mousemove",s[25])],D=!0)},p(u,L){const R={};L[1]&8&&(R.$$scope={dirty:L,ctx:u}),d.$set(R);const z={};L[0]&4097&&(z.onInput=u[20]),!f&&L[0]&64&&(f=!0,z.textContent=u[6],lt(()=>f=!1)),g.$set(z);const Q={};L[0]&7&&(Q.isActive=!(u[0]||u[1]||u[2])),L[1]&8&&(Q.$$scope={dirty:L,ctx:u}),j.$set(Q),(!h||L[0]&256)&&ee(a,"--json-editor-height",u[8]),(!h||L[0]&2048)&&ee(a,"--flow-editor-height",u[11]);const N={};L[0]&4143|L[1]&8&&(N.$$scope={dirty:L,ctx:u}),I.$set(N);const me={};L[1]&8&&(me.$$scope={dirty:L,ctx:u}),E.$set(me);const ot={};w.$set(ot)},i(u){h||(O(d.$$.fragment,u),O(g.$$.fragment,u),O(j.$$.fragment,u),O(I.$$.fragment,u),O(E.$$.fragment,u),O(w.$$.fragment,u),h=!0)},o(u){J(d.$$.fragment,u),J(g.$$.fragment,u),J(j.$$.fragment,u),J(I.$$.fragment,u),J(E.$$.fragment,u),J(w.$$.fragment,u),h=!1},d(u){u&&(k(r),k(o),k(l)),k(e),k(t),k(n),K(d),s[21](null),K(g),s[23](null),K(j),K(I),K(E),s[31](null),K(w,u),D=!1,de(C)}}}function jn(s,e,t){let n,r,o;re(s,x,N=>t(12,r=N)),re(s,Lt,N=>t(33,o=N));let a,i;ke(()=>{$e.set(i.highlightLines)});let d=!1,v=!1,m=!1,b,{data:_}=e;if(_.systemId)r.id===_.systemId?x.set(r):o.has(_.systemId)?x.set({id:_.systemId,json:Ee(_.systemId)}):ke(()=>{ne("/")});else{let N;[_.systemId,N]=Mt(),b=N.name,x.set({id:_.systemId,json:N}),ke(()=>{ne(`/system-editor/${_.systemId}`,{replaceState:!0})})}let c="";x.subscribe(N=>{t(6,c=JSON.stringify(N.json,null,2)),t(5,b=N.json.name),t(2,m=!Ht())});let g,f=200,y="",S=!1;const j=N=>{const me=g.getBoundingClientRect();t(18,f=me.bottom-N.clientY+8)};let M;const I=()=>{if(r.json.components.length===0||Ye.isEqual(r.json,Ee(r.id))){ne("/");return}else M.openDialog(`You have unsaved changes. Do you want to save ${b}?`,"Yes","No").then(N=>{if(N)H();else{ne("/");return}})},H=()=>{Je(r.id,r.json),Oe.set({message:"System saved successfully!",type:"success",duration:3e3}),ne("/")},E=()=>{d||v||m||(Ye.isEqual(r.json,Ee(r.id))?ne(`/analysis/${r.id}`):M.openDialog("You have unsaved changes. Do you want to save them before proceeding?","Save changes","Cancel").then(N=>{N&&(Je(r.id,r.json),ne(`/analysis/${r.id}`))}))},l=()=>{t(9,S=!0)},w=N=>{t(0,d=!zt(N,r.id))};function h(N){ue[N?"unshift":"push"](()=>{i=N,t(4,i)})}function D(N){c=N,t(6,c)}function C(N){ue[N?"unshift":"push"](()=>{g=N,t(7,g)})}const T=()=>{t(9,S=!1)},X=N=>{S&&j(N)},A=()=>Tt(r.json),u=N=>t(1,v=!At(N,r.id)),L=()=>a.click();function R(N){ue[N?"unshift":"push"](()=>{a=N,t(3,a)})}const z=N=>Bt(N,!1);function Q(N){ue[N?"unshift":"push"](()=>{M=N,t(10,M)})}return s.$$set=N=>{"data"in N&&t(17,_=N.data)},s.$$.update=()=>{s.$$.dirty[0]&7&&(d||v||m||Oe.set(null)),s.$$.dirty[0]&262144&&t(8,y=`${f}px`),s.$$.dirty[0]&262144&&t(11,n=`calc(100% - ${f}px)`)},[d,v,m,a,i,b,c,g,y,S,M,n,r,j,I,H,E,_,f,l,w,h,D,C,T,X,A,u,L,R,z,Q]}class Xn extends le{constructor(e){super(),ie(this,e,jn,$n,ae,{data:17},null,[-1,-1])}}export{Xn as component,Jn as universal};
